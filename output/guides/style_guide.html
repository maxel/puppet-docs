<!DOCTYPE html>
<html dir="ltr" lang="en-US">
  <head>
  	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  	<title>Documentation | Puppet Labs - Style Guide</title>
  	<meta name="description" content="The open source leader in data center automation">
  	<link rel="alternate" type="text/xml" title="Puppet Labs RSS 0.92 Feed" href="http://puppetlabs.com/feed/rss/">
  	<link rel="alternate" type="application/atom+xml" title="Puppet Labs Atom Feed" href="http://puppetlabs.com/feed/atom/">
  	<link rel="alternate" type="application/rss+xml" title="Puppet Labs RSS 2.0 Feed" href="http://puppetlabs.com/feed/">
  	<link rel="pingback" href="http://puppetlabs.com/xmlrpc.php">
    <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://puppetlabs.com/xmlrpc.php?rsd" />
    <link rel='index' title='Puppet Labs' href='http://docs.puppetlabs.com' />

<!-- Google stats -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-1537572-5");
pageTracker._setDomainName(".puppetlabs.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- End Google stats -->


    <!-- FIXME: absolute paths -->

    <script type='text/javascript' src='/files/javascripts/html5.js'></script>
    <script type='text/javascript' src='/files/javascripts/jquery-1.3.2.min.js'></script>
    <script type='text/javascript' src='/files/javascripts/drop_down.js'></script>
    <script type='text/javascript' src='/files/javascripts/cufon-yui.js'></script>
    <script type='text/javascript' src='/files/fonts/Klavika_400-Klavika_600.font.js'></script>
    <script type='text/javascript' src='/files/javascripts/ampersands.js'></script>

     <!--Add rotation jQuery Script -->
	 	
    <script type='text/javascript' src='/files/javascripts/addRotate.js'></script>

    <!-- All in One SEO Pack 1.6.10.1 by Michael Torbert of Semper Fi Web Design[127,146] -->
    <meta name="keywords" content="Puppet, puppet labs, reductive labs, open source, system administrator, ruby, data center, automation, support" />
    <link rel="canonical" href="http://docs.puppetlabs.com" />
    <!-- /all in one seo pack -->
	
    <!-- FIXME: absolute paths -->

    <link rel="stylesheet" type="text/css" href="/files/stylesheets/style.css" media="screen"> 
    <link rel="stylesheet" type="text/css" href="/files/stylesheets/syntax.css" media="screen"> <!-- index -->

    <!--[if IE 7]>
	  <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_7.css" media="screen"> <!-- index -->
    <![endif]-->
  
    <!--[if IE 8]>
	    <link rel="stylesheet" type="text/css" href="/files/stylesheets/ie_8.css" media="screen"> <!-- index -->
    <![endif]-->		

  	<script type="text/javascript">
      Cufon.replace('h1, h2', { fontWeight: '600' });
  	</script>
</head>



        
  <body id="resources" class="docs">
  <style type="text/css">h1, h2{ visibility : hidden }</style>		
  <!--[if IE 8]>
    <style type="text/css">h1, h2{ visibility : visible }</style>
  <![endif]-->		

  	<header id="header">
      <div class="site-width">
    		<h1><a href="http://puppetlabs.com/"><span>Puppet Labs</span></a></h1>
        <a class="screen-reader-content" href="#content">Skip navigation</a>
        <nav>
    		<ul id="global-navigation">
          <li id="puppet-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/puppet/">
              <span>Products</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>            
              <li>
                <ul>
<li class="page_item page-item-769"><a href="http://www.puppetlabs.com/puppet/puppet-enterprise/" title="Puppet Enterprise">Puppet Enterprise</a></li>
<li class="page_item page-item-757"><a href="http://www.puppetlabs.com/puppet/introduction/" title="Puppet">Puppet</a></li>
<li class="page_item page-item-956"><a href="http://www.puppetlabs.com/puppet/how-to-buy/" title="How to Buy">How to Buy</a></li>
<li class="page_item page-item-1159"><a href="http://forge.puppetlabs.com/" title="Module Forge">Module Forge</a></li>

<li class="page_item page-item-2415"><a href="http://www.puppetlabs.com/mcollective/introduction/" title="MCollective">MCollective</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li id="services-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/services/">
              <span>Services</span>
              <span class="drop-down-trigger"></span>

            </a>
            <ul>
              <li class="page_item page-item-783"><a href="http://www.puppetlabs.com/services/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-839"><a href="http://www.puppetlabs.com/services/support/" title="Enterprise Support">Enterprise Support</a></li>
<li class="page_item page-item-845"><a href="http://www.puppetlabs.com/services/training-workshops/" title="On-Site Training &amp; Consulting">On-Site Training &amp; Consulting</a></li>
<li class="page_item page-item-849"><a href="/category/events/upcoming/" title="Events &amp; Public Training">Events &amp; Public Training</a></li>
<li class="page_item page-item-851"><a href="http://www.puppetlabs.com/services/partners/" title="Partners">Partners</a></li>
<li class="page_item page-item-1037"><a href="/resources/customer-support" title="Customer Support">Customer Support</a></li>
            </ul>
          </li>
          <li id="resources-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/resources/">
              <span>Resources</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://www.puppetlabs.com/resources/overview-2/" title="Overview">Overview</a></li>
<li class="page_item page-item-1052"><a href="http://www.puppetlabs.com/resources/customer-support/" title="Customer Support">Customer Support</a></li>
<li class="page_item page-item-1040"><a href="http://docs.puppetlabs.com" title="Documentation">Documentation</a></li>
<li class="page_item page-item-872"><a href="http://info.puppetlabs.com/register-download" title="Downloads">Downloads</a></li>
<li class="page_item page-item-1961"><a href="http://forge.puppetlabs.com" title="Module Forge">Module Forge</a></li>
<li class="page_item page-item-835"><a href="http://info.puppetlabs.com/request-whitepapers.html" title="White Papers">White Papers</a></li>
<li class="page_item page-item-1967"><a href="http://projects.puppetlabs.com/projects/puppet/wiki" title="Wiki">Wiki</a></li>
            </ul>

          </li>

<li id="customer-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/customers/companies/">
              <span>Customers</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-1048"><a href="http://www.puppetlabs.com/customers/companies/" title="Overview">Companies</a></li>
<li class="page_item page-item-1052"><a href="http://www.puppetlabs.com/customers/case-studies/" title="Case Studies">Case Studies</a></li>
<li class="page_item page-item-1040"><a href="http://www.puppetlabs.com/customers/product-testimonials/" title="Product Testimonials">Product Testimonials</a></li>
<li class="page_item page-item-872"><a href="http://www.puppetlabs.com/customers/what-customers-are-saying/" title="ervice Testimonials">Service Testimonials</a></li>
	</ul>
          </li>
         <li id="community-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/community/">
              <span>Community</span>

              <span class="drop-down-trigger"></span>
            </a>
            <ul>
              <li class="page_item page-item-2195"><a href="http://www.puppetlabs.com/community/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2195"><a href="http://www.puppetlabs.com/blog" title="Blog">Blog</a></li>
<li class="page_item page-item-2264"><a href="http://www.puppetlabs.com/community/puppet-camp/" title="Puppet Camp">Puppet Camp</a></li>
<li class="page_item page-item-2249"><a href="http://www.puppetlabs.com/community/user-groups-and-devops-groups/" title="User Groups &amp; DevOps Groups">User Groups &amp; DevOps Groups</a></li>
<li class="page_item page-item-2215"><a href="http://www.puppetlabs.com/community/presentations/" title="Presentations">Presentations</a></li>

<li class="page_item page-item-2217"><a href="http://www.puppetlabs.com/community/videos/" title="Videos">Videos</a></li>
<li class="page_item page-item-2217"><a href="http://www.puppetlabs.com/community/badges/" title="Badges">Badges</a></li>
            </ul>
          </li>

          <li id="company-tab" class="with-submenu">
            <a href="http://www.puppetlabs.com/company/">
              <span>Company</span>
              <span class="drop-down-trigger"></span>
            </a>

            <ul>
              <li class="page_item page-item-2316"><a href="http://www.puppetlabs.com/company/overview/" title="Overview">Overview</a></li>
<li class="page_item page-item-2179"><a href="http://www.puppetlabs.com/company/news/" title="News">News</a></li>
<li class="page_item page-item-1571"><a href="http://www.puppetlabs.com/company/jobs/" title="Jobs">Jobs</a></li>
<li class="page_item page-item-2313"><a href="http://www.puppetlabs.com/company/contact-us/" title="Contact Us">Contact Us</a></li>
            </ul>
          </li>
    		</ul>	   
          <div id="misc-navigation">

			  <ul>
				<li><a href="http://docs.puppetlabs.com">Documentation</a></li>
				<li><a href="http://puppetlabs.com/resources/customer-support/">Support</a></li>
				<li><a href="http://projects.puppetlabs.com/">Bug Tracker</a></li>
				<li><a href="http://puppetlabs.com/company/#contact">Contact Us</a></li>
				<li><a href="http://puppetlabs.com/resources/downloads" class="gateway">Download</a></li>
			  </ul>
			<form action="http://www.google.com/cse" id="cse-search-box">

			  <div>
				<input type="hidden" name="cx" value="017884045025332504017:1mnj-dlgfcc" />
				<input type="hidden" name="ie" value="UTF-8" />
				<input type="text" name="q" size="31" />
				<input type="submit" name="sa" class="searchbtn" value="Search" />
			  </div>
			</form>
			<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&lang=en"></script>

          </div>
      </nav>
    	</div>
    </header>  

      <section id="masthead">
        <div class="site-width">
          <h1>Docs: <span class="section-name">Style Guide</span></h1>
          <ul id="doc-navigation">
            <li><a href="/">Docs Home</a></li>
            <li class="with-submenu">
              <a href="#">
                <span>Quick Nav</span>
                <span class="drop-down-trigger"></span>
              </a>
               <!-- the following links can't be relative, unfortunately -->
               <!-- future: add some JS to disable this if running from file:// -->
	            <dl>
	              <dt>Puppet Guides</dt>
                      <dd><a href="/index.html">Index</a></dd>
                  <dt>Puppet References</dt>
                      <dd><a href="/references/latest/type.html">Resource Types</a></dd>
                      <dd><a href="/references/latest/function.html">Functions</a></dd>
                      <dd><a href="/references/latest/metaparameter.html">Metaparameters</a></dd>
                      <dd><a href="/references/latest/configuration.html">Configuration</a></dd>
                  <dt>References By Version</dt>
                      <dd><a href="/references/2.6.7/">2.6.7</a></dd>
                      <dd><a href="/references/0.25.5/">0.25.5</a></dd> 
                      <dd><a href="/references/0.24.8/">0.24.8</a></dd>
                      <dd><a href="/references/">Other Versions</a></dd>
                  <dt>MCollective</dt>
                      <dd><a href="/mcollective/index.html">Index</a></dd>
                      <dd><a href="/mcollective/simplerpc/index.html">SimpleRPC</a></dd>
                      <dd><a href="/mcollective/roadmap/index.html">Roadmap</a></dd>
                      <dd><a href="/mcollective/releasenotes.html">Release Notes</a></dd>
                      <dd><a href="/mcollective/reference/index.html">References</a></dd>
	            </dl>
            </li>
            <li><a href="/contribute.html">Contribute</a></li>
          </ul>
        </div>
      </section>
    
      <section id="content">
        <div class="site-width">
          <div class="primary-secondary-content">
            <div class="primary-content">
              <h1 id="style-guide">Style Guide</h1>

<hr />

<h3 id="style-guide-metadata">Style Guide Metadata</h3>

<p>Version 1.0</p>

<h2 id="terminology">Terminology</h2>

<p>The key words &ldquo;MUST&rdquo;, &ldquo;MUST NOT&rdquo;, &ldquo;REQUIRED&rdquo;, &ldquo;SHALL&rdquo;, &ldquo;SHALL NOT&rdquo;,
&ldquo;SHOULD&rdquo;, &ldquo;SHOULD NOT&rdquo;, &ldquo;RECOMMENDED&rdquo;,  &rdquo;MAY&rdquo;, and &ldquo;OPTIONAL&rdquo; in
this document are to be interpreted as described in
<a href="http://www.google.com/url?q=http://www.faqs.org/rfcs/rfc2119.html&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHSKK-6ZHOhijUT4-3b9Bhi7FI0Ww">RFC 2119</a>.</p>

<h2 id="puppet-version">Puppet version</h2>

<p>This style guide is largely specific to Puppet version 2.6.x and makes
recommendations based on some language features that are only 
available starting in version 2.6.0 and later.</p>

<h2 id="why-a-style-guide">Why a Style Guide?</h2>

<p>Puppet Labs develops modules for customers and the community.</p>

<p>These modules should represent the best practise in the
organisation for module design and style.  Since these modules are
designed by a number of people across the organisation this guide
is designed to ensure a consistent pattern, design and style is
adopted and maintained.</p>

<h2 id="general-philosophies">General Philosophies</h2>

<p>The following general ideas should be kept in mind when making
judgement calls about style.  The question “Does this block of
syntax conform to the style guide?” may very well be answered by
the following guidelines.</p>

<ol>
  <li>Readability matters.<br />
There is a strong preference for code that is more readable when
presented with alternatives that are more difficult to read.  Note,
this is highly subjective, so this is by no means a hard and fast
rule.  Please use your best judgement as to what “readable” means.
If you can read your own code 3 months from now, that’s a great start.</li>
  <li>Inheritance should be avoided.
In general, inheritance leads to code that is harder to read. 
Most use cases for inheritance can be replaced by exposing class
parameters that can be used to configure resource attributes. See 
the Class Inheritance section for more details.</li>
  <li>Modules must not require an ENC.  Modules must operate with
ENC’s.<br />
When surveyed, there was near consensus that an ENC should not be
required.  At the same time, every module we write should work well
with an ENC.</li>
  <li>Classes should generally not declare other classes.<br />
There is a strong preference to declare classes as
close to node scope as possible. Classes which require other
classes should not directly declare them and should instead allow
the system to fail if they are not declared by some other means.
(Note: The reason is because of the non-deterministic scoping
issues.  If class multi-declarations result in deterministic
behavior in the future, this philosophy may be revisited.)</li>
</ol>

<h2 id="module-metadata">Module Metadata</h2>

<p>Every module must have Metadata defined in the Modulefile data file
and outputted as the metadata.json file.  The following Metadata
should be provided for all modules.</p>

<pre><code>name 'myuser-mymodule'  
version '0.0.1'
author ‘Author of the module - for shared modules this is Puppet Labs’
summary ‘One line description of the module’
description ‘Longer description of the module including an example’
license ‘The license the module is release under - generally GPLv2 or Apache’
project_page ‘The URL where the module source is located’  
dependency 'otheruser-othermodule', '1.2.3'
</code></pre>

<h3 id="versioning">Versioning</h3>

<p>The style guide must be version controlled, so that modules can be
compliant to a specific version of the style guide.</p>

<p>This meta information must be embedded in the
Modulefile.  Use the field named ‘style_version’ e.g.</p>

<pre><code>style_version "1.0"
</code></pre>

<h2 id="spacing-indentation--whitespace">Spacing, Indentation, &amp; Whitespace</h2>

<p>Puppet Labs has some basic style rules for spacing, indentation and
whitespace.  These are:</p>

<ol>
  <li>Must use 2 space soft tabs</li>
  <li>Must not use literal tabs</li>
  <li>Must not leave trailing white space</li>
  <li>Should not exceed 80 columns</li>
  <li>Should align fat commas</li>
</ol>

<h2 id="comments">Comments</h2>

<p>Generally a # based comment is more readable using editors such as
vim.  The hash based comments are strongly preferable to C style
/* */ and // comments.</p>

<ol>
  <li>Should use # style comments</li>
  <li>Should not use // or /* */ comments</li>
</ol>

<h2 id="quoting">Quoting</h2>

<p>All strings that do not contain variables should be enclosed in
single quotes.  Double quotes should be used when interpolation is
required.  Quoting is optional when the string is an alphanumeric
bare word and not a resource title.</p>

<p>All variables should be enclosed in braces when interpolated in a
string.  For example:</p>

<div class="highlight"><pre><code class="ruby">    <span class="s2">&quot;/etc/${file}.conf&quot;</span>
    <span class="s2">&quot;${operatingsystem} is not supported by ${module_name}&quot;</span>
</code></pre>
</div>

<p>Should not use the following styles:</p>

<div class="highlight"><pre><code class="ruby">    <span class="s2">&quot;/etc/$file.conf&quot;</span>
    <span class="s2">&quot;$operatingsystem is not supported by $module_name&quot;</span>
</code></pre>
</div>

<p>Variables standing by themselves should not be enclosed in double
quotes.  For example:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">mode</span> <span class="o">=&gt;</span> <span class="vg">$my_mode</span>
</code></pre>
</div>

<p>and should not use the following style:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">mode</span> <span class="o">=&gt;</span> <span class="s2">&quot;$my_mode&quot;</span>
    <span class="n">mode</span> <span class="o">=&gt;</span> <span class="s2">&quot;${my_mode}&quot;</span>
</code></pre>
</div>

<h2 id="resources">Resources</h2>

<h3 id="resource-names">Resource Names</h3>

<p>All resource names (titles) should be quoted. Although Puppet
supports unquoted resource names if they do not contain spaces or
hyphens, placing all names in quotes allows for consistent
look-and-feel.</p>

<p>Should not use the syntax:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">package</span> <span class="p">{</span> <span class="n">openssh</span><span class="p">:</span> <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span> <span class="p">}</span>
</code></pre>
</div>

<p>Should use the syntax:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">package</span> <span class="p">{</span> <span class="s1">&#39;openssh&#39;</span><span class="p">:</span> <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span> <span class="p">}</span>
</code></pre>
</div>

<h3 id="arrow-alignment">Arrow alignment</h3>

<p>The arrow (=&gt;) should be aligned at the column one space out from
the longest parameter. Not obvious in the above example is that the
arrow is only aligned per resource.</p>

<p>Therefore, the following is correct:</p>

<div class="highlight"><pre><code class="ruby">    <span class="nb">exec</span> <span class="p">{</span> <span class="s1">&#39;blah&#39;</span><span class="p">:</span>  
      <span class="n">path</span> <span class="o">=&gt;</span> <span class="s1">&#39;/usr/bin&#39;</span><span class="p">,</span>  
      <span class="n">cwd</span>  <span class="o">=&gt;</span> <span class="s1">&#39;/tmp&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nb">exec</span> <span class="p">{</span> <span class="s1">&#39;test&#39;</span><span class="p">:</span>  
      <span class="n">subscribe</span>   <span class="o">=&gt;</span> <span class="no">File</span><span class="o">[</span><span class="s1">&#39;/etc/test&#39;</span><span class="o">]</span><span class="p">,</span>  
      <span class="n">refreshonly</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>The following is incorrect:</p>

<div class="highlight"><pre><code class="ruby">    <span class="nb">exec</span> <span class="p">{</span> <span class="s1">&#39;blah&#39;</span><span class="p">:</span>  
     <span class="n">path</span> <span class="o">=&gt;</span> <span class="s1">&#39;/usr/bin&#39;</span><span class="p">,</span>  
     <span class="n">cwd</span> <span class="o">=&gt;</span> <span class="s1">&#39;/tmp&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nb">exec</span> <span class="p">{</span> <span class="s1">&#39;test&#39;</span><span class="p">:</span>  
      <span class="n">subscribe</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="o">[</span><span class="s1">&#39;/etc/test&#39;</span><span class="o">]</span><span class="p">,</span>  
      <span class="n">refreshonly</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="parameter-ordering">Parameter Ordering</h3>

<p>Ensure should be the first parameter if it is specified in a
resource declaration.</p>

<ol>
  <li>Ensure is often the most “essential” property and listing it
first helps readability.</li>
  <li>Puppet internally does optimizations and always evaluates
ensure first so that in the event ensure is set to absent it does
not try to sync type/provider properties and it does this no matter
where you define the ensure inside the resource block.  This
recommendation is a readability recommendation only.</li>
</ol>

<p>The following syntax is a recommended example:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;/tmp/foo&#39;</span><span class="p">:</span>
      <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">file</span><span class="p">,</span>
      <span class="n">owner</span>  <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
      <span class="n">group</span>  <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
      <span class="n">mode</span>   <span class="o">=&gt;</span> <span class="s1">&#39;0644&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="compression">Compression</h3>

<p>All resources of a given type should not be grouped together in a
given manifest</p>

<p>The following examples are NOT recommended:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">file</span> <span class="p">{</span>
      <span class="s2">&quot;/tmp/a&quot;</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=&gt;</span> <span class="s2">&quot;a&quot;</span><span class="p">;</span>
      <span class="s2">&quot;/tmp/b&quot;</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=&gt;</span> <span class="s2">&quot;b&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nb">exec</span> <span class="p">{</span>
      <span class="s2">&quot;change contents of a&quot;</span><span class="p">:</span>
        <span class="n">command</span> <span class="o">=&gt;</span> <span class="s2">&quot;sed -i.bak s/b/B/g /tmp/a&quot;</span><span class="p">;</span>
      <span class="s2">&quot;change contents of b&quot;</span><span class="p">:</span>
        <span class="n">command</span> <span class="o">=&gt;</span> <span class="s2">&quot;sed -i.bak s/b/B/g /tmp/b&quot;</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>The following examples are RECOMMENDED:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;/tmp/a&#39;</span><span class="p">:</span>
      <span class="n">content</span> <span class="o">=&gt;</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nb">exec</span> <span class="p">{</span> <span class="s1">&#39;change contents of a&#39;</span><span class="p">:</span>
      <span class="n">command</span> <span class="o">=&gt;</span> <span class="s1">&#39;sed -i.bak s/a/A/g /tmp/a&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;/tmp/b&#39;</span><span class="p">:</span>
      <span class="n">content</span> <span class="o">=&gt;</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nb">exec</span> <span class="p">{</span> <span class="s1">&#39;change contents of b&#39;</span><span class="p">:</span>
      <span class="n">command</span> <span class="o">=&gt;</span> <span class="s1">&#39;sed -i.bak s/b/B/g /tmp/b&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="symbolic-links">Symbolic Links</h3>

<p>To make the intended behavior explicitly clear symbolic links
should be declared using the ensure =&gt; link property value rather
than a relative path to the target.  The following example is
recommended:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;/var/log/syslog&#39;</span><span class="p">:</span>
      <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">symlink</span><span class="p">,</span>
      <span class="n">target</span> <span class="o">=&gt;</span> <span class="s1">&#39;/var/log/messages&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="file-modes">File modes</h3>

<p>When specifying file modes in File resources the mode should be
represented as 4 digits, instead of 3, to make the mode explicit.</p>

<p>In addition, the mode should be specified in a single quoted
string instead of a bare word number.</p>

<p>Syntax should resemble:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;/var/log/syslog&#39;</span><span class="p">:</span>
      <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span>
      <span class="n">mode</span>   <span class="o">=&gt;</span> <span class="s1">&#39;0644&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Syntax should not resemble:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;/var/log/syslog&#39;</span><span class="p">:</span>
      <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span>
      <span class="n">mode</span>   <span class="o">=&gt;</span> <span class="mi">644</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="resource-defaults">Resource defaults</h3>

<p>Resource defaults should only be used in a very controlled manner,
restricted to the edges of your manifest ecosystem.  This is due to
the affect dynamic scope has on the default’s definition and our
inability to track which resources it applies to reliably.</p>

<p>Correct:</p>

<p>/etc/puppetlabs/puppet/manifests/site.pp:</p>

<div class="highlight"><pre><code class="ruby">    <span class="no">File</span> <span class="p">{</span>
      <span class="n">mode</span>   <span class="o">=&gt;</span> <span class="s1">&#39;0644&#39;</span><span class="p">,</span>
      <span class="n">owner</span>  <span class="o">=&gt;</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
      <span class="n">group</span>  <span class="o">=&gt;</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>Incorrect:</p>

<p>/etc/puppetlabs/puppet/modules/ssh/manifests/server/uk/foo.pp</p>

<div class="highlight"><pre><code class="ruby">    <span class="no">File</span> <span class="p">{</span>
      <span class="n">mode</span>   <span class="o">=&gt;</span> <span class="s1">&#39;0600&#39;</span><span class="p">,</span>
      <span class="n">owner</span>  <span class="o">=&gt;</span> <span class="s1">&#39;nobody&#39;</span><span class="p">,</span>
      <span class="n">group</span>  <span class="o">=&gt;</span> <span class="s1">&#39;nogroup&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<h2 id="conditionals">Conditionals</h2>

<h3 id="keep-resource-declarations-simple">Keep resource declarations simple</h3>

<p>You should not intermingle conditionals with your resource
declarations. When using conditionals for data assignment, you
should separate conditional code from the resource declarations.</p>

<p>The following examples are recommended:</p>

<div class="highlight"><pre><code class="ruby">    <span class="vg">$foo_mode</span> <span class="o">=</span> <span class="vg">$operatingsystem</span> <span class="p">?</span> <span class="p">{</span>
      <span class="n">debian</span> <span class="o">=&gt;</span> <span class="s1">&#39;0007&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;/tmp/foo&#39;</span><span class="p">:</span>
       <span class="n">mode</span> <span class="o">=&gt;</span> <span class="vg">$foo_mode</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>The following examples are not recommended:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">file</span> <span class="p">{</span> <span class="s1">&#39;/tmp/foo&#39;</span><span class="p">:</span>
      <span class="n">mode</span> <span class="o">=&gt;</span> <span class="vg">$operatingsystem</span> <span class="p">?</span> <span class="p">{</span>
        <span class="n">debian</span> <span class="o">=&gt;</span> <span class="s1">&#39;0777&#39;</span><span class="p">,</span>
        <span class="n">redhat</span> <span class="o">=&gt;</span> <span class="s1">&#39;0776&#39;</span><span class="p">,</span>
        <span class="n">fedora</span> <span class="o">=&gt;</span> <span class="s1">&#39;0007&#39;</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="defaults-for-case-statements-and-selectors">Defaults for case statements and selectors</h3>

<p>Case statements should have default statements.</p>

<p>Hence both of these are valid.  In addition, the default case
should fail the catalog compilation when the resulting behavior
cannot be predicted on the majority of platforms the module will be
used on.</p>

<p>For selectors, the ommission of a default selection should only be
used if catalog compilation failure is explicitly desired in this
case.</p>

<p>The following example follows the recommended style:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">case</span> <span class="vg">$operatingsystem</span> <span class="p">{</span>
      <span class="n">centos</span><span class="p">:</span> <span class="p">{</span>
        <span class="vg">$version</span> <span class="o">=</span> <span class="s1">&#39;1.2.3&#39;</span>
      <span class="p">}</span>
      <span class="n">solaris</span><span class="p">:</span> <span class="p">{</span>
        <span class="vg">$version</span> <span class="o">=</span> <span class="s1">&#39;3.2.1&#39;</span>
      <span class="p">}</span>
      <span class="n">default</span><span class="p">:</span> <span class="p">{</span>
        <span class="nb">fail</span><span class="p">(</span><span class="s2">&quot;Module $module_name is not supported on $operatingsystem&quot;</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<h2 id="classes">Classes</h2>

<h3 id="separate-files">Separate files</h3>

<p>All classes and defines must be in separate files located in the
manifests directory of the given module, for example:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">init</span><span class="o">.</span><span class="n">pp</span>
      <span class="k">class</span> <span class="n">foo</span> <span class="p">{</span> <span class="p">}</span>
    <span class="n">bar</span><span class="o">.</span><span class="n">pp</span>
      <span class="k">class</span> <span class="n">foo</span><span class="o">::</span><span class="n">bar</span> <span class="p">{</span> <span class="p">}</span>
    <span class="n">dostuff</span><span class="o">.</span><span class="n">pp</span>
      <span class="n">define</span> <span class="n">foo</span><span class="o">::</span><span class="n">dostuff</span> <span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</code></pre>
</div>

<h3 id="internal-organization-of-a-class">Internal Organization of a class</h3>

<p>Classes should be organised with a consistent structure and style.
In the below list there is an implicit statement of &ldquo;should be at this relative
location&rdquo; for each of these items.  The word &ldquo;may&rdquo; should be
interpreted as &ldquo;If there are any X’s they should be here&rdquo;.</p>

<ol>
  <li>Should define the class and parameters</li>
  <li>Should validate any class parameters and fail catalog compilation if any parameters are invalid </li>
  <li>Should default any validated parameters to the most general case</li>
  <li>May declare local variables</li>
  <li>May declare relationships to other classes Class[&lsquo;foo&rsquo;] -&gt; Class[&lsquo;bar&rsquo;]</li>
  <li>May override resources</li>
  <li>May declare resource defaults</li>
  <li>May declare defined resource types</li>
  <li>May declare native types (Users, Groups, Services&hellip;)</li>
  <li>May declare other resources</li>
  <li>May declare Resource relationships inside of conditionals</li>
</ol>

<p>The following example follows the recommended style:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">myservice</span><span class="p">(</span><span class="vg">$ensure</span><span class="o">=</span><span class="s1">&#39;running&#39;</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">if</span> <span class="vg">$ensure</span> <span class="k">in</span> <span class="o">[</span> <span class="n">running</span><span class="p">,</span> <span class="n">stopped</span> <span class="o">]</span> <span class="p">{</span>
        <span class="vg">$ensure_real</span> <span class="o">=</span> <span class="vg">$ensure</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">fail</span><span class="p">(</span><span class="s1">&#39;ensure parameter must be running or stopped&#39;</span><span class="p">)</span>
      <span class="p">}</span>

      <span class="k">case</span> <span class="vg">$operatingsystem</span> <span class="p">{</span>
        <span class="n">centos</span><span class="p">:</span> <span class="p">{</span>
          <span class="vg">$package_list</span> <span class="o">=</span> <span class="s1">&#39;openssh-server&#39;</span>
        <span class="p">}</span>
        <span class="n">solaris</span><span class="p">:</span> <span class="p">{</span>
          <span class="vg">$pacakge_list</span> <span class="o">=</span> <span class="o">[</span> <span class="no">SUNWsshr</span><span class="p">,</span> <span class="no">SUNWsshu</span> <span class="o">]</span>
        <span class="p">}</span>
        <span class="n">default</span><span class="p">:</span> <span class="p">{</span>
          <span class="nb">fail</span><span class="p">(</span><span class="s2">&quot;module $module_name does not support $operatingsystem&quot;</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="vg">$variable</span> <span class="o">=</span> <span class="s1">&#39;something&#39;</span>

      <span class="no">Package</span> <span class="p">{</span> <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span> <span class="p">}</span>

      <span class="no">File</span> <span class="p">{</span> <span class="n">owner</span> <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">group</span> <span class="o">=&gt;</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=&gt;</span> <span class="s1">&#39;0644&#39;</span> <span class="p">}</span>
  
      <span class="n">package</span> <span class="p">{</span> <span class="vg">$package_list</span><span class="p">:</span> <span class="p">}</span>

      <span class="n">file</span> <span class="p">{</span> <span class="s2">&quot;/tmp/${variable}&quot;</span><span class="p">:</span>
        <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="n">present</span><span class="p">,</span>
      <span class="p">}</span>

      <span class="n">service</span> <span class="p">{</span> <span class="s1">&#39;myservice&#39;</span><span class="p">:</span>
        <span class="k">ensure</span>    <span class="o">=&gt;</span> <span class="vg">$ensure_real</span><span class="p">,</span>
        <span class="n">hasstatus</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="relationship-declarations">Relationship Declarations</h3>

<p>Relationship declarations should only be used in the “left to
right” direction.  For example, the syntax Service[foo] &lt;-
Package[bar] should not be used, instead the syntax Package[bar]
-&gt; Service[foo] should be used.</p>

<p>Meta-parameters should be used in preference to relationship
declarations when possible.  An example when it is not possible is
when meta-parameters would require the use of subclasses to
override behavior.  In this situation, relationship
declarations inside of conditionals should be used.</p>

<h3 id="classes-within-classes">Classes within classes</h3>

<p>Classes must not be defined within other classes.</p>

<p>This example shall not be followed:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">foo</span> <span class="p">{</span>
      <span class="k">class</span> <span class="n">bar</span> <span class="p">{</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span> <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="defines-within-classes">Defines within classes</h3>

<p>Resources must not be defined within classes.</p>

<p>The following example shall not be followed:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">foo</span> <span class="p">{</span>
      <span class="n">define</span> <span class="n">bar</span><span class="p">()</span> <span class="p">{</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span> <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="class-inheritance">Class Inheritance</h3>

<p>Inheritance may only be used within a module and must not be used
across module name spaces. This is a result of:</p>

<ol>
  <li>Portability - inheriting outside of the module
breaks the idea of modules and limits our ability for portability</li>
  <li>inheritance outside of the module is indicative of code
that should be refactored. In this instance you probably should be 
using includes or parameterized classes</li>
</ol>

<p>Inheritance should be avoided when alternatives are viable.  For
example, if inheritance is being used to override relationships
when stopping a service by overriding the relationship of a class
managing a running service, the code should be refactored to use a
single class with an ensure parameter and relationship declarations
inside of conditionals. An example of this follows. The example makes 
several assumptions and is based on an example provided in the Puppet 
Master training for managing bluetooth.</p>

<ol>
  <li>Class inheritance is only useful for overriding resource
parameters.</li>
  <li>The most commonly overridden parameters are relationship
meta-parameters.</li>
  <li>Other parameters, e.g. ensure and enable may have behavior
changed through the use of variables and conditional logic.</li>
</ol>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">bluetooth</span><span class="p">(</span><span class="vg">$ensure</span><span class="o">=</span><span class="n">present</span><span class="p">,</span> <span class="vg">$autoupgrade</span><span class="o">=</span><span class="kp">false</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1"># Validate class parameter inputs. (Fail early and fail hard)</span>

       <span class="k">if</span> <span class="o">!</span> <span class="p">(</span><span class="vg">$ensure</span> <span class="k">in</span> <span class="o">[</span> <span class="s2">&quot;present&quot;</span><span class="p">,</span> <span class="s2">&quot;absent&quot;</span> <span class="o">]</span><span class="p">)</span> <span class="p">{</span>
         <span class="nb">fail</span><span class="p">(</span><span class="s2">&quot;bluetooth ensure parameter must be absent or present&quot;</span><span class="p">)</span>
       <span class="p">}</span>

       <span class="k">if</span> <span class="o">!</span> <span class="p">(</span><span class="vg">$autoupgrade</span> <span class="k">in</span> <span class="o">[</span> <span class="kp">true</span><span class="p">,</span> <span class="kp">false</span> <span class="o">]</span><span class="p">)</span> <span class="p">{</span>
         <span class="nb">fail</span><span class="p">(</span><span class="s2">&quot;bluetooth autoupgrade parameter must be true or false&quot;</span><span class="p">)</span>
       <span class="p">}</span>

       <span class="c1"># Set local variables based on the desired state</span>

       <span class="k">if</span> <span class="vg">$ensure</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span> <span class="p">{</span>
         <span class="vg">$service_enable</span> <span class="o">=</span> <span class="kp">true</span>
         <span class="vg">$service_ensure</span> <span class="o">=</span> <span class="n">running</span>
         <span class="k">if</span> <span class="vg">$autoupgrade</span> <span class="o">==</span> <span class="kp">true</span> <span class="p">{</span>
           <span class="vg">$package_ensure</span> <span class="o">=</span> <span class="n">latest</span>
         <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
           <span class="vg">$package_ensure</span> <span class="o">=</span> <span class="n">present</span>
         <span class="p">}</span>
       <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
         <span class="vg">$service_enable</span> <span class="o">=</span> <span class="kp">false</span>
         <span class="vg">$service_ensure</span> <span class="o">=</span> <span class="n">stopped</span>
         <span class="vg">$package_ensure</span> <span class="o">=</span> <span class="n">absent</span>
       <span class="p">}</span>

       <span class="c1"># Declare resources without any relationships in this section</span>

       <span class="n">package</span> <span class="p">{</span> <span class="o">[</span> <span class="s2">&quot;bluez-libs&quot;</span><span class="p">,</span> <span class="s2">&quot;bluez-utils&quot;</span><span class="o">]</span><span class="p">:</span>
         <span class="k">ensure</span> <span class="o">=&gt;</span> <span class="vg">$package_ensure</span><span class="p">,</span>
       <span class="p">}</span>

       <span class="n">service</span> <span class="p">{</span> <span class="n">hidd</span><span class="p">:</span>
         <span class="n">enable</span>         <span class="o">=&gt;</span> <span class="vg">$service_enable</span><span class="p">,</span>
         <span class="k">ensure</span>         <span class="o">=&gt;</span> <span class="vg">$service_ensure</span><span class="p">,</span>
         <span class="n">status</span>         <span class="o">=&gt;</span> <span class="s2">&quot;source /etc/init.d/functions; status hidd&quot;</span><span class="p">,</span>
         <span class="n">hasstatus</span>      <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
         <span class="n">hasrestart</span>     <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
      <span class="p">}</span>

      <span class="c1"># Finally, declare relations based on desired behavior</span>

      <span class="k">if</span> <span class="vg">$ensure</span> <span class="o">==</span> <span class="s2">&quot;present&quot;</span> <span class="p">{</span>
        <span class="no">Package</span><span class="o">[</span><span class="s2">&quot;bluez-libs&quot;</span><span class="o">]</span>  <span class="o">-&gt;</span> <span class="no">Package</span><span class="o">[</span><span class="s2">&quot;bluez-utils&quot;</span><span class="o">]</span>
        <span class="no">Package</span><span class="o">[</span><span class="s2">&quot;bluez-libs&quot;</span><span class="o">]</span>  <span class="o">~&gt;</span> <span class="no">Service</span><span class="o">[</span><span class="n">hidd</span><span class="o">]</span>
        <span class="no">Package</span><span class="o">[</span><span class="s2">&quot;bluez-utils&quot;</span><span class="o">]</span> <span class="o">~&gt;</span> <span class="no">Service</span><span class="o">[</span><span class="n">hidd</span><span class="o">]</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="no">Service</span><span class="o">[</span><span class="s2">&quot;hidd&quot;</span><span class="o">]</span>        <span class="o">-&gt;</span> <span class="no">Package</span><span class="o">[</span><span class="s2">&quot;bluez-utils&quot;</span><span class="o">]</span>
        <span class="no">Package</span><span class="o">[</span><span class="s2">&quot;bluez-utils&quot;</span><span class="o">]</span> <span class="o">-&gt;</span> <span class="no">Package</span><span class="o">[</span><span class="s2">&quot;bluez-libs&quot;</span><span class="o">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>In the event you cannot avoid inheritance then rhe following example may be used:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">ssh</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="n">ssh</span><span class="o">::</span><span class="n">client</span> <span class="n">inherits</span> <span class="n">ssh</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="n">ssh</span><span class="o">::</span><span class="n">server</span> <span class="n">inherits</span> <span class="n">ssh</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="n">ssh</span><span class="o">::</span><span class="n">server</span><span class="o">::</span><span class="n">solaris</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>The following examples must not be followed:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">ssh</span> <span class="n">inherits</span> <span class="n">server</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="n">ssh</span><span class="ss">:client</span> <span class="n">inherits</span> <span class="n">workstation</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>

    <span class="k">class</span> <span class="n">wordpress</span> <span class="n">inherits</span> <span class="n">apache</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>
</code></pre>
</div>

<h3 id="name-space-variables">Name space variables</h3>

<p>When using variables Puppet modules should access top scope
variables explicitly to prevent scoping issues.</p>

<div class="highlight"><pre><code class="ruby">    <span class="vg">$:</span><span class="ss">:operatingsystem</span><span class="p">,</span> <span class="ow">not</span> <span class="vg">$operatingsystem</span>
</code></pre>
</div>

<h3 id="specifying-the-order-of-class-parameters">Specifying the order of class parameters</h3>

<p>In parameterized classes, parameters that are required should be
specified before optional parameters (or parameters with defaults)</p>

<p>Example:</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">foo</span> <span class="p">(</span>
      <span class="vg">$one</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
      <span class="vg">$two</span><span class="p">,</span>
      <span class="vg">$three</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
    <span class="p">)</span> <span class="p">{}</span>
</code></pre>
</div>

<p>should be rewritten as</p>

<div class="highlight"><pre><code class="ruby">    <span class="k">class</span> <span class="n">foo</span> <span class="p">(</span>
      <span class="vg">$two</span><span class="p">,</span>
      <span class="vg">$one</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
      <span class="vg">$three</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
    <span class="p">)</span> <span class="p">{}</span>
</code></pre>
</div>

<h2 id="tests">Tests</h2>

<p>All manifests should have a corresponding tests manifest, for
example the following manifests:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">modulepath</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">manifests</span><span class="o">/</span><span class="p">{</span><span class="n">init</span><span class="p">,</span><span class="n">foo</span><span class="p">}</span><span class="o">.</span><span class="n">pp</span>
</code></pre>
</div>

<p>Should have matching tests:</p>

<div class="highlight"><pre><code class="ruby">    <span class="n">modulepath</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="p">{</span><span class="n">init</span><span class="p">,</span><span class="n">foo</span><span class="p">}</span><span class="o">.</span><span class="n">pp</span>
</code></pre>
</div>

<h2 id="puppet-doc">Puppet Doc</h2>

<p>For generation of decent looking Puppet documentation the following
conventions should be used.</p>

<p>As class headers:</p>

<div class="highlight"><pre><code class="ruby">    <span class="c1"># Full description of class here.</span>
    <span class="c1">#</span>
    <span class="c1"># == Parameters</span>
    <span class="c1">#</span>
    <span class="c1"># Document parameters here</span>
    <span class="c1">#</span>
    <span class="c1"># [*sample_bar*]</span>
    <span class="c1">#   Description of this variable.</span>
    <span class="c1">#</span>
    <span class="c1"># == Variables</span>
    <span class="c1">#</span>
    <span class="c1"># Here you should define a list of variables that this module would require.</span>
    <span class="c1">#</span>
    <span class="c1"># [*$foo_var*]</span>
    <span class="c1">#     Description of this variable</span>
    <span class="c1">#</span>
    <span class="c1"># == Examples</span>
    <span class="c1">#</span>
    <span class="c1"># Put some examples on how to use your class here.</span>
    <span class="c1">#</span>
    <span class="c1">#   $example_var = &quot;blah&quot;</span>
    <span class="c1">#   include example_class</span>
    <span class="c1">#</span>
    <span class="c1"># == Authors</span>
    <span class="c1">#</span>
    <span class="c1"># Author Name &lt;author@domain.com\&gt;</span>
    <span class="c1">#</span>
    <span class="c1"># == Copyright</span>
    <span class="c1">#</span>
    <span class="c1"># Copyright 2011 Company Name Inc, unless otherwise noted.</span>
    <span class="c1">#</span>
    <span class="k">class</span> <span class="n">example_class</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>
</code></pre>
</div>

<p>For defined resources:</p>

<div class="highlight"><pre><code class="ruby">    <span class="c1"># Description of resource here</span>
    <span class="c1">#</span>
    <span class="c1"># == Parameters</span>
    <span class="c1">#</span>
    <span class="c1"># Document parameters here</span>
    <span class="c1">#</span>
    <span class="c1"># [*namevar*]</span>
    <span class="c1">#   Always document namevar</span>
    <span class="c1">#</span>
    <span class="c1"># [*sample_bar*]</span>
    <span class="c1">#   Description of this variable.</span>
    <span class="c1">#</span>
    <span class="c1"># == Examples</span>
    <span class="c1">#</span>
    <span class="c1"># Provide some examples on how to use this type:</span>
    <span class="c1">#</span>
    <span class="c1">#   example_class::example_resource{</span>
    <span class="c1">#     &quot;namevar&quot;:</span>
    <span class="c1">#       sample_param =&gt; &quot;value&quot;,</span>
    <span class="c1">#   }</span>
    <span class="c1">#</span>
    <span class="n">define</span> <span class="n">example_class</span><span class="o">::</span><span class="n">example_resource</span><span class="p">(</span><span class="vg">$example_var</span><span class="p">)</span> <span class="p">{</span>
      <span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="p">}</span>
</code></pre>
</div>

<h2 id="the-extlookup-function">The extlookup() function</h2>

<p>Modules should avoid the use of extlookup() in favor of ENCs or other alternatives.</p>

            </div>
            <div class="secondary-content">
                  <div id="subCol">
                  
                  
                      <h3 class="chapter">Contents</h3>
                      <ol class="chapters">
                      <ol class="toc"><li><a href="#style-guide-metadata">Style Guide Metadata</a></li><li><a href="#terminology">Terminology</a></li><li><a href="#puppet-version">Puppet version</a></li><li><a href="#why-a-style-guide">Why a Style Guide?</a></li><li><a href="#general-philosophies">General Philosophies</a></li><li><a href="#module-metadata">Module Metadata</a></li><li><a href="#versioning">Versioning</a></li><li><a href="#spacing-indentation--whitespace">Spacing, Indentation, &amp; Whitespace</a></li><li><a href="#comments">Comments</a></li><li><a href="#quoting">Quoting</a></li><li><a href="#resources">Resources</a></li><li><a href="#resource-names">Resource Names</a></li><li><a href="#arrow-alignment">Arrow alignment</a></li><li><a href="#parameter-ordering">Parameter Ordering</a></li><li><a href="#compression">Compression</a></li><li><a href="#symbolic-links">Symbolic Links</a></li><li><a href="#file-modes">File modes</a></li><li><a href="#resource-defaults">Resource defaults</a></li><li><a href="#conditionals">Conditionals</a></li><li><a href="#keep-resource-declarations-simple">Keep resource declarations simple</a></li><li><a href="#defaults-for-case-statements-and-selectors">Defaults for case statements and selectors</a></li><li><a href="#classes">Classes</a></li><li><a href="#separate-files">Separate files</a></li><li><a href="#internal-organization-of-a-class">Internal Organization of a class</a></li><li><a href="#relationship-declarations">Relationship Declarations</a></li><li><a href="#classes-within-classes">Classes within classes</a></li><li><a href="#defines-within-classes">Defines within classes</a></li><li><a href="#class-inheritance">Class Inheritance</a></li><li><a href="#name-space-variables">Name space variables</a></li><li><a href="#specifying-the-order-of-class-parameters">Specifying the order of class parameters</a></li><li><a href="#tests">Tests</a></li><li><a href="#puppet-doc">Puppet Doc</a></li><li><a href="#the-extlookup-function">The extlookup() function</a></li></ol>
                      </ol>
                  
                  </div>
            </div>
          </div>
        </div>
      </section>

		<footer id="footer">
      <div class="site-width">

        <div class="primary-secondary-content">
          <div class="primary-content">
            <section id="newsletter">
                 <h4>Puppet Labs is Hiring</h4>
                 <p><a href="http://www.puppetlabs.com/company/jobs/">Engineers, developers & consultants</a>
                  <p>  
		<h4>Newsletter</h4>

              <p>Stay up to date on all things puppet</p>
              
				<form class="lpeRegForm formNotEmpty" method="post" enctype="application/x-www-form-urlencoded" action="http://info.puppetlabs.com/index.php/leadCapture/save"; id="mktForm_1013" name="mktForm_1013">
				
				<label>Email Address:</label><span class='mktInput'><input class='mktFormText mktFormEmail' name="Email" id="Email" type='text' value="" maxlength='255'  /><span class='mktFormMsg'></span></span>
				
				<input id='mktFrmSubmit' type='submit' class='btn' style="width: auto; overflow: visible; padding-left: .25em; padding-right: .25em;" value='Subscribe' name='submitButton' onclick='formSubmit(document.getElementById("mktForm_1013")); return false;' />
				
				<input style='display: none;' id='mktFrmReset' type='reset' value='Clear' name='resetButton' onclick='formReset(document.getElementById("mktForm_1013")); return false;' />
	
				<span style="display:none;"><input type="text" name="_marketo_comments" value="" /></span>
				<input type="hidden" name="lpId" value="-1" />
				<input type="hidden" name="subId" value="100" />

				<input type="hidden" name="kw" value="" />
				<input type="hidden" name="cr" value="" />
				
				<input type="hidden" name="searchstr" value="" />
				<input type="hidden" name="lpurl" value="http://info.puppetlabs.com/testsubscription.html?cr={creative}&kw={keyword}"; />
				<input type="hidden" name="formid" value="1013" />
				<input type="hidden" name="returnURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="retURL" value="http://www.puppetlabs.com/misc/subscription-thank-you/"; />
				<input type="hidden" name="_mkt_disp" value="return" />
				<input type="hidden" name="_mkt_trk" value="" />

				</form>
				<script type="text/javascript" src="http://info.puppetlabs.com/js/mktFormSupport.js"></script>
				
				<script type="text/javascript">
				function formSubmit(elt) {
				return Mkto.formSubmit(elt);
				}
				function formReset(elt) {
				return Mkto.formReset(elt);
				}
				</script>
              
<a href="http://info.puppetlabs.com/puppet-enterprise" class="fbtn">Try Puppet Enterprise FREE</a>

            </section>
            <section id="elsewhere">
              <h4>Get Involved</h4>
              <ul>

                <li class="chat"><a href="http://webchat.freenode.net/?channels=puppet" rel="external"><span class="indicator"></span><span>Chat with us on IRC</span></a></li>
		<li class="discussion"><a href="http://groups.google.com/group/puppet-dev" rel="external"><span class="indicator"></span><span>Join the Puppet Developer List</span></a></li>
                <li class="discussion"><a href="http://groups.google.com/group/puppet-users?pli=1" rel="external"><span class="indicator"></span><span>Join the Puppet User List</span></a></li>
                
                <li class="linkedin"><a href="http://www.linkedin.com/groups?about=&gid=696467&trk=anet_ug_grppro" rel="external"><span class="indicator"></span><span>Join the Puppet Users LinkedIn group</span></a></li>	

              </ul>
		<p>
		              		<h4>Follow us&#8230;</h4>

              		<ul class="followus">

					
			<li><a href="http://feeds.feedburner.com/PuppetLabs" target="_blank"><img src="http://www.puppetlabs.com/wp-content/plugins/my-profiles/images/rss.png" border="0"></a></li>
			<li><a href="http://www.facebook.com/pages/Puppet-Labs/219089920711" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/facebook.png" border="0"></a></li>
			<li><a href="http://www.twitter.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/plugins/my-profiles/images/twitter.png" border="0"></a></li>
			<li><a href="http://www.linkedin.com/groups?about=&amp;gid=696467&amp;trk=anet_ug_grppro" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/LinkedIn_IN_Icon_32px.png" border="0"></a></li>    <li><a href="https://github.com/puppetlabs" target="_blank"><img src="http://www.puppetlabs.com//wp-content/uploads/2011/01/github_icon.png" border="0"></a></li>
					</ul>

              	</p>

            </section>
          </div>
          <div class="secondary-content">
            <section id="book-it">
              <h4>Get the book!</h4>

              <p>Written by James Turnbull, <a href="http://apress.com/book/view/1590599780" rel="nofollow">Pulling Strings with Puppet</a> is the first book to introduce the powerful Puppet system administration tool. </p>
              <a href="http://apress.com/book/view/1590599780" rel="nofollow"><img src="http://www.puppetlabs.com/images/book.png" /></a>
            </section>
          </div>
        </div>
      </div>
		</footer>

    <div id="copyright">
      <div class="site-width">
        &copy; 2011 <a href="http://www.puppetlabs.com/" title="Puppet Labs">Puppet Labs</a>
        <span class="vcard">
         <span class="org"></span>
         <a class="email" href="mailto:info@puppetlabs.com">info@puppetlabs.com</a>

          <span class="adr">
           <span class="street-address">411 NW Park Street</span>
           /
           <span class="locality">Portland</span>, 
           <span class="region">OR</span>
           <span class="postal-code">97209</span>

          </span>

         <span class="tel">1-877-575-9775</span>
        </span>          
      </div>
    </div>
    <script src="http://munchkin.marketo.net/munchkin.js" type="text/javascript"></script> <script>mktoMunchkin("307-QLA-991");</script> 
    
  	<script type="text/javascript">Cufon.now();</script>
  	<style type="text/css">h1, h2, .btn { visibility : visible; }</style>

	</body>
</html>        
